{"is_source_file": true, "format": "Python", "description": "This is a Python source file implementing security-related functionalities for a FastAPI application. It provides functions for password hashing, password verification, JWT token creation, token decoding, and user retrieval based on JWT tokens. It defines dependencies and manages authentication flow within the backend server.", "external_files": ["src/core/config.py", "src/core/database.py", "src/models/models.py"], "external_methods": ["get_settings", "get_db", "User"], "published": ["get_password_hash", "verify_password", "create_access_token", "get_current_user"], "classes": [{"name": "User", "description": "User model class representing users in the database."}], "methods": [{"name": "str get_password_hash(password: str)", "description": "Hash a plaintext password using bcrypt.", "scope": "", "scopeKind": ""}, {"name": "bool verify_password(plain_password: str, hashed_password: str)", "description": "Verify a plaintext password against a bcrypt hash.", "scope": "", "scopeKind": ""}, {"name": "str create_access_token( subject: Union[str, int, Dict[str, Any]], expires_delta: Optional[timedelta] = None, )", "description": "Create a signed JWT access token with an optional expiration.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] _decode_token(token: str)", "description": "Decode and validate a JWT token. Raises HTTP 401 on failure.", "scope": "", "scopeKind": ""}, {"name": "User get_current_user(token: str = Depends(_oauth2_scheme), db: Session = Depends(get_db))", "description": "Dependency that extracts the current authenticated user from the JWT token.", "scope": "", "scopeKind": ""}], "calls": ["jwt.encode", "jwt.decode", "get_settings", "get_db", "db.get"], "search-terms": ["security.py", "JWT", "password hashing", "OAuth2PasswordBearer", "FastAPI security", "JWT token creation", "user authentication"], "state": 2, "file_id": 26, "knowledge_revision": 62, "git_revision": "", "ctags": [{"_type": "tag", "name": "_decode_token", "path": "/home/kavia/workspace/code-generation/cinestream--movie--web-series-streaming-app-96446-96626/Backend/src/core/security.py", "pattern": "/^def _decode_token(token: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "_oauth2_scheme", "path": "/home/kavia/workspace/code-generation/cinestream--movie--web-series-streaming-app-96446-96626/Backend/src/core/security.py", "pattern": "/^_oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_pwd_context", "path": "/home/kavia/workspace/code-generation/cinestream--movie--web-series-streaming-app-96446-96626/Backend/src/core/security.py", "pattern": "/^_pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_settings", "path": "/home/kavia/workspace/code-generation/cinestream--movie--web-series-streaming-app-96446-96626/Backend/src/core/security.py", "pattern": "/^_settings = get_settings()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/cinestream--movie--web-series-streaming-app-96446-96626/Backend/src/core/security.py", "pattern": "/^def create_access_token($/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "( subject: Union[str, int, Dict[str, Any]], expires_delta: Optional[timedelta] = None, )"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/cinestream--movie--web-series-streaming-app-96446-96626/Backend/src/core/security.py", "pattern": "/^def get_current_user(token: str = Depends(_oauth2_scheme), db: Session = Depends(get_db)) -> Use/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "(token: str = Depends(_oauth2_scheme), db: Session = Depends(get_db))"}, {"_type": "tag", "name": "get_password_hash", "path": "/home/kavia/workspace/code-generation/cinestream--movie--web-series-streaming-app-96446-96626/Backend/src/core/security.py", "pattern": "/^def get_password_hash(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/cinestream--movie--web-series-streaming-app-96446-96626/Backend/src/core/security.py", "pattern": "/^def verify_password(plain_password: str, hashed_password: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(plain_password: str, hashed_password: str)"}], "hash": "da2733c42455c898935d9ca84d282623", "format-version": 4, "code-base-name": "Backend", "filename": "Backend/src/core/security.py", "fields": [{"name": "_oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_settings = get_settings()", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"62": ""}]}